---
description: Interactive command for requesting human judgment in decision-making scenarios. Used for personal preferences, project-specific information, destructive operation confirmations, and other situations requiring human input.
---

# HITL (Human-in-the-Loop) Command

このコマンドは、Claude Codeが人間の判断や情報が必要な状況で使用するカスタムコマンドです。

## 使用方法

```
/hitl <質問内容>
```

## 動作仕様

このコマンドが呼び出されたら、以下の手順で動作してください：

### 1. 質問の整形と表示

```
========================================
🤔 人間の判断が必要です
========================================

【質問】
<質問内容をここに表示>

【コンテキスト】
<なぜこの情報が必要かを簡潔に説明>

【選択肢】（該当する場合）
<可能な選択肢をリスト表示>

========================================
回答をお待ちしています...
```

### 2. 回答の待機

- ユーザーの回答を待機
- 回答が不明確な場合は、明確化を求める
- タイムアウトはなし（ユーザーが回答するまで待機）

### 3. 回答の確認と処理

```
【受信した回答】
<ユーザーの回答>

この理解で正しいですか？ (yes/修正内容を入力)
```

### 4. 回答に基づく処理の継続

- 受け取った情報を使って作業を継続
- 必要に応じて追加の質問を行う

## 使用すべきシーン

### 必須使用シーン

1. **個人的な好み・設定**
   - コーディングスタイルの好み
   - ツールの選択（例：npm vs yarn vs pnpm）
   - 命名規則の確認

2. **プロジェクト固有の情報**
   - 本番環境の設定
   - APIキーやトークンの場所
   - デプロイ先の確認

3. **曖昧な指示の明確化**
   - 複数の解釈が可能な要求
   - 実装方法に複数の選択肢がある場合

4. **破壊的操作の最終確認**
   - データベースのマイグレーション
   - 大量ファイルの変更
   - 設定ファイルの上書き

### 使用例

```
/hitl このプロジェクトでTypeScriptのstrictモードは有効にすべきですか？既存のコードベースとの互換性を考慮する必要があります。

/hitl デプロイ先はどこですか？選択肢：1) Vercel, 2) Netlify, 3) AWS, 4) その他

/hitl データベースのマイグレーションを実行します。本番データに影響があります。続行しますか？

/hitl このファイルの命名規則はcamelCaseとkebab-caseのどちらを使用していますか？
```

## 実装の詳細

### 質問のカテゴリ分類

質問を以下のカテゴリに分類して、適切なフォーマットで表示：

1. **Yes/No質問**
   - 明確に「はい」「いいえ」で答えられる質問
   - デフォルトの選択肢を提示

2. **選択式質問**
   - 番号付きの選択肢を提示
   - 「その他」オプションを含める

3. **自由記述質問**
   - 具体的な情報を求める質問
   - 例示を含めて期待する回答形式を示す

4. **確認質問**
   - 実行前の最終確認
   - 影響範囲を明確に表示

### エラーハンドリング

```
【エラー】回答を理解できませんでした

もう一度お答えください：
- Yes/No質問の場合: 「yes」または「no」で回答
- 選択式の場合: 番号（1, 2, 3...）で回答
- 自由記述の場合: 具体的な内容を入力
```

### 履歴の記録

すべてのHITL対話は、以下の形式でログに記録：

```markdown
## HITL Log: [日時]

**質問**: <質問内容>
**コンテキスト**: <コンテキスト>
**回答**: <ユーザーの回答>
**アクション**: <回答に基づいて取った行動>
```

## 注意事項

1. **プライバシー配慮**
   - パスワードやAPIキーを直接聞かない
   - 代わりに保存場所や環境変数名を確認

2. **質問の最小化**
   - 本当に必要な情報のみを質問
   - 推測可能な情報は質問しない

3. **コンテキストの提供**
   - なぜその情報が必要かを明確に説明
   - 質問の背景を理解できるようにする

4. **タイミングの配慮**
   - 関連する質問はまとめて行う
   - 作業の流れを不必要に中断しない
