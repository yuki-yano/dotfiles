---
description: Finalize and format today's daily report from work logs
---

# 日報を完成させる: $ARGUMENTS

## 引数（ARGUMENTS）

オプション指定：

```bash
# 引数なし - 今日の日報を完成
nippo-finalize

# 特定の日付を指定
nippo-finalize 2025-01-01
nippo-finalize yesterday

# 出力形式を指定
nippo-finalize --format slack     # Slack投稿用フォーマット
nippo-finalize --format markdown  # 標準Markdownフォーマット（デフォルト）
```

## 目標

散在する作業ログから構造化された日報を自動生成し、振り返りと共有を容易にする

## 実行手順

### 1. 対象ファイルの特定

```bash
# 日付の解析
if [ -z "$ARGUMENTS" ] || [[ "$ARGUMENTS" == --format* ]]; then
    DATE=$(perl -MPOSIX -le 'print strftime("%Y-%m-%d", localtime)')
elif [ "$ARGUMENTS" = "yesterday" ]; then
    DATE=$(perl -MPOSIX -le 'print strftime("%Y-%m-%d", localtime(time - 86400))')
else
    DATE="$ARGUMENTS"
fi

FILENAME="ai/log/nippo/${DATE}.md"

# ファイルの存在確認
if [ ! -f "$FILENAME" ]; then
    echo "日報ファイルが見つかりません: $FILENAME"
    echo "先に nippo-add で作業記録を追加してください"
    exit 1
fi
```

### 2. 作業ログの分析と整理

現在の日報ファイルを読み込み、以下の処理を実行：

1. **進捗状況の自動集計**
   - 完了した作業の数をカウント
   - Issue/PRの対応状況を整理
   - 作業時間の概算（最初と最後のログから）

2. **カテゴリ別に整理**
   - 実装/開発
   - レビュー/フィードバック
   - ミーティング/コミュニケーション
   - 調査/学習
   - その他

3. **重要ポイントの抽出**
   - 主要な成果
   - 発生した課題と解決策
   - 得られた知見

### 3. 各セクションの補完と整形

#### 今日の目標セクション
- 作業ログから達成項目を特定
- チェックボックスの更新
- 達成率の計算

#### 進捗状況セクション
```markdown
## 📊 進捗状況

### 完了した作業（X件）
- ✅ [主要な完了項目のリスト]

### 進行中の作業（Y件）
- 🔄 [継続中の項目]

### 成果指標
- コミット数: X
- PR作成: Y
- レビュー: Z
- 解決Issue: W
```

#### 学びと気づきセクション
- 「振り返り:」「学び:」タグから自動抽出
- 技術的な発見を整理
- 改善点の明確化

#### 明日への申し送りセクション
- 未完了タスクの整理
- 優先順位の提案
- ブロッカーの明記

### 4. フォーマット別出力

#### 標準Markdownフォーマット（デフォルト）
構造化された読みやすい形式で出力

#### Slackフォーマット（--format slack）
```
【日報】YYYY-MM-DD

*今日の成果* 🎯
• 主要な完了項目1
• 主要な完了項目2

*進行中* 🔄
• 継続タスク1

*課題と対策* ⚠️
• 課題: XXX → 対策: YYY

*明日の予定* 📅
• 優先タスク1
• 優先タスク2

*今日の学び* 💡
• 技術的な発見や気づき
```

### 5. 完成した日報の保存

```bash
# バックアップを作成
cp "$FILENAME" "${FILENAME}.bak"

# 整形済みの内容で上書き
# [整形された内容をファイルに書き込む]

# 完了メッセージ
echo "================================================================================
日報を完成させました: $FILENAME
================================================================================

【サマリー】
- 完了タスク: X件
- 進行中: Y件
- 今日の学び: Z件
- 作業時間: 約H時間（最初: HH:MM、最後: HH:MM）

日報を確認: nippo-show
Slackに投稿する場合: nippo-show --format slack"
```

### 6. オプション: 週次サマリーの生成

金曜日の場合、週次サマリーも自動生成：

```markdown
## 📅 今週のサマリー（MM/DD - MM/DD）

### 主な成果
- [今週の重要な完了項目]

### 来週への持ち越し
- [未完了の重要タスク]

### 振り返り
- [今週の学びと改善点]
```

## AIによる補完内容

以下の内容をAIが作業ログから推測・補完：

1. **要約の生成**
   - 1日の作業を3行で要約
   - 主要な成果のハイライト

2. **カテゴリ分類**
   - 作業内容を自動でカテゴライズ
   - 時間配分の可視化

3. **改善提案**
   - 作業ログから非効率な部分を検出
   - より良いアプローチの提案

4. **感情分析**
   - ポジティブ/ネガティブな記述から調子を判断
   - モチベーション維持のためのフィードバック

## エラーハンドリング

1. **日報ファイルが存在しない**
   - 利用可能な日付をリスト表示
   - nippo-add の使用を促す

2. **作業ログが少ない**
   - 最低限の情報で日報を生成
   - より詳細な記録を推奨

3. **フォーマットエラー**
   - 元のファイルを保持（.bak）
   - 手動修正の方法を提示

## 関連コマンド

- `nippo-add`: 作業記録を追加
- `nippo-show`: 日報を表示
- `save-session`: より詳細なセッション情報を保存