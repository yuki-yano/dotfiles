## ファイル作成・編集ルール

### 改行コード

- ファイルの終端は必ずLF（\n）にする
- 既に終端がLFの場合は追加しない（重複を避ける）
- これはすべてのテキストファイル（.md・.ts・.json等）に適用する

### フォーマット

- 空白だけの行は改行文字のみにする（空白文字を含めない）
- 文章の末尾の空白は削除する
- 行末に不要な空白文字を残さない

## AI作業ディレクトリのルール

### ディレクトリ構造と用途
プロジェクトのAI支援作業では、以下のディレクトリ構造を使用してください：

1. **`ai/tmp/`** - 一時的な作業ファイル
   - デバッグ、実験、検証用
   - セッション終了時に削除可能

2. **`ai/log/`** - 時系列の作業記録
   - `features/` - 実装した機能
   - `fixes/` - バグ修正
   - `tests/` - テスト実行結果
   - `sessions/` - セッション引き継ぎ
   - ファイル名: `YYYY-MM-DD-説明.md`

3. **`ai/knowledge/`** - 恒久的な知識ベース
   - `learnings/` - 技術的な学習事項
   - `decisions/` - アーキテクチャ決定
   - `patterns/` - ベストプラクティス
   - `context/` - プロジェクトコンテキスト

4. **`ai/issues/`** - 問題管理
   - `active/` - 対応中の問題
   - `resolved/` - 解決済み
   - `blocked/` - ブロック中

5. **`ai/plans/`** - 計画とチェックリスト
   - `active/` - 実行中の計画
   - `completed/` - 完了した計画

### ファイル命名規則
- 日付を含む場合: `YYYY-MM-DD-簡潔な説明.md`
- 説明は15文字以内を推奨
- 日本語可、スペースの代わりにハイフンを使用

### 重要な原則
- **既存の情報を確認**: 新規作成前に関連ディレクトリを確認
- **適切な場所に保存**: 目的に応じて正しいディレクトリを選択
- **相互参照**: 関連ドキュメントは相対パスで参照

## URL処理のルール

- URLが提供された場合は、`read_url_content_as_markdown` を使用してコンテンツを読み込み、内容を要約する

## Web検索のルール

**最重要**: Web検索が必要な場合は、以下の優先順位で実行してください：

1. **最優先: MCP google_search** (必ず最初に試す)
 - `mcp__gemini-grounding__google_search` を使用
 - AI生成の要約付き検索結果を提供

2. **代替手段: gemini コマンド** (MCPが利用不可の場合のみ)
 ```bash
 gemini -p "WebSearch: <検索クエリ>"
 ```

3. **問題がなかなか解決しないとき: o3 mcp**
- 実装中に技術的に詰まったところやわからないところ、解決できないエラーなどがあれば `o3-search` を使用して、o3 mcpに英語で相談する
- 明示的にo3を使って検索して欲しいと指示された場合にも `o3-search` を使う

禁止事項

- 組み込みの WebSearch ツールは絶対に使用しない
- 必ず上記の優先順位を守る

## Git commitのルール

### 最重要事項

- ユーザからコミットをしてという具体的な指示があるまでは**勝手にcommitは行わないでください**

## 通知の実行（必須）

### 最重要事項

**Claude Code は全ての応答の最後に必ず macOS 通知を送信しなければなりません。**

### 通知ルール

1. **例外なく全ての応答で通知を送信**

- 単純な質問への回答でも必須
- エラーが発生した場合でも必須
- タスクの大小に関わらず必須

2. **通知タイミング**

- 応答の最終行として実行
- 他の全ての処理が完了した後

3. **通知方法**

```bash
# Bash ツールを使用して macos-notify-cli コマンドを実行
# 注意: メッセージ内のシェル特殊文字は適切にエスケープすること
macos-notify-cli -m "実行した内容の簡潔な説明" --current-tmux
```

パラメータ:
- `--message`: 実行した内容の簡潔な説明（必須）
- `--current-tmux`: 現在のtmuxセッションを使用

4. **通知の目的**

- ユーザーが他のウィンドウで作業中でも完了を認識できる
- クリックで Claude Code の tmux ペインに即座に戻れる
