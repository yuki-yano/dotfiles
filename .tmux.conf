# Default
unbind C-b
set -g prefix C-g
bind C-g send-prefix

set  -g default-terminal "screen-256color"
set -sg escape-time 0
set  -g history-limit 50000
set  -g status-interval 5

set  -g base-index 1
set  -g pane-base-index 1
set  -g renumber-windows on;
set  -g status-position top
setw -g mode-keys vi
set  -g mouse on
setw -g automatic-rename on
set  -g default-command "reattach-to-user-namespace -l $SHELL"

# Plugin
set -g @plugin 'tmux-plugins/tpm'

set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'nhdaly/tmux-better-mouse-mode'
set -g @plugin 'tmux-plugins/tmux-logging'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-sessionist'

# Binding

## Move Pane
bind -T prefix h select-pane -L
bind -T prefix j select-pane -D
bind -T prefix k select-pane -U
bind -T prefix l select-pane -R

## Move Window
bind -T prefix n   next-window
bind -T prefix p   previous-window
bind -T prefix C-g last-window
bind -n M-1        select-window -t 1
bind -n M-2        select-window -t 2
bind -n M-3        select-window -t 3
bind -n M-4        select-window -t 4
bind -n M-5        select-window -t 5
bind -n M-6        select-window -t 6
bind -n M-7        select-window -t 7
bind -n M-8        select-window -t 8
bind -n M-9        select-window -t 9

## Split Window
bind -T prefix c new-window       -c "#{pane_current_path}"
bind -T prefix v split-window -h  -c "#{pane_current_path}"
bind -T prefix s split-window -v  -c "#{pane_current_path}"
bind -T prefix V split-window -fh -c "#{pane_current_path}"
bind -T prefix S split-window -fv -c "#{pane_current_path}"
bind -n M--      split-window -v  -c "#{pane_current_path}"
bind -n M-|      split-window -h  -c "#{pane_current_path}"
bind -n M-_      split-window -fv -c "#{pane_current_path}"
bind -n M-\      split-window -fh -c "#{pane_current_path}"

## Resize Pane
bind -T prefix C-h resize-pane -L 10
bind -T prefix C-l resize-pane -R 10
bind -T prefix C-j resize-pane -D 10
bind -T prefix C-k resize-pane -U 10

## Swap Pane
bind -T prefix > swap-pane -D
bind -T prefix < swap-pane -U
bind -n M-J      swap-pane -D
bind -n M-K      swap-pane -U
bind -n M-M      swap-pane -d -t :.1
bind -n M-Space  next-layout

## New Window
bind -n M-Enter new-window -c "#{pane_current_path}"

## Full Screen
bind -n M-f resize-pane -Z

## Rename Session
bind -T prefix r command-prompt -p "(rename-session '#S')" "rename-session '%%'"

## Kill pane &&  window
bind -n M-x kill-pane
bind -n M-X kill-window

## Join Pane
bind -n M-'!' join-pane -t :1
bind -n M-'"' join-pane -t :2
bind -n M-'#' join-pane -t :3
bind -n M-'$' join-pane -t :4
bind -n M-'%' join-pane -t :5
bind -n M-'&' join-pane -t :6
bind -n M-"'" join-pane -t :7
bind -n M-'(' join-pane -t :8
bind -n M-')' join-pane -t :9

## Move Session
bind -T prefix H switch-client -p
bind -T prefix L switch-client -n

## Move Selection
bind -T prefix a   choose-tree
bind -T prefix C-a choose-tree
bind -T prefix e   choose-session
bind -T prefix C-e choose-session
bind -T prefix w   choose-tree -w
bind -T prefix C-w choose-tree -w

## Copy Mode
bind -T copy-mode-vi C-a    send-keys -X start-of-line
bind -T copy-mode-vi C-e    send-keys -X end-of-line
bind -T copy-mode-vi v      send-keys -X begin-selection
bind -T copy-mode-vi V      send-keys -X select-line
bind -T copy-mode-vi C-v    send-keys -X rectangle-toggle
bind -T copy-mode-vi y      send-keys -X copy-pipe-and-cancel
bind -T copy-mode-vi Escape send-keys -X cancel

# Vim Tmux Navigator
is_vim="ps -o state= -o comm= -t '#{pane_tty}'  | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
bind -n C-h if-shell "$is_vim" "send-keys C-h"  "select-pane -L"
bind -n C-j if-shell "$is_vim" "send-keys C-j"  "select-pane -D"
bind -n C-k if-shell "$is_vim" "send-keys C-k"  "select-pane -U"
bind -n C-l if-shell "$is_vim" "send-keys C-l"  "select-pane -R"
bind -n C-\ if-shell "$is_vim" "send-keys C-\\" "select-pane -l"
bind -T copy-mode-vi C-h select-pane -L
bind -T copy-mode-vi C-j select-pane -D
bind -T copy-mode-vi C-k select-pane -U
bind -T copy-mode-vi C-l select-pane -R
bind -T copy-mode-vi C-\ select-pane -l
bind -T prefix       C-l send-keys C-l

# Status Line
set -g status-fg colour251
set -g status-bg colour8

set -g pane-border-fg colour8
set -g pane-active-border-fg colour15

set -g status-left-length  150
set -g status-right-length 150
set -g status-left "#[fg=colour108,bg=colour8,bold] [#S:#I:#P] "

setw -g window-status-current-format "#[fg=colour173,bg=colour8,bold,nounderscore]#I #W "
setw -g window-status-format "#[fg=colour68,bg=colour8]#I #W "

set -g status-right '#(tmux-prefix-highlight) #(cpu) | #(memory) | #(swap) | #(loadaverage) / #(wifi) #(battery) '
set -g status-justify left

# Message line
set -g message-fg white
set -g message-bg colour235
set -g message-attr bright

if "test -e ~/.tmux.conf.local" "source ~/.tmux.conf.local"

run '~/.tmux/plugins/tpm/tpm'
