#!/usr/bin/env bash

file=$(echo "$1" | awk '{if (substr($0,1,1) ~ /??|M|A|D/) print $2}')

if [[ -n $(git ls-files "$file") ]]; then
  if [[ $2 == "--cached" ]]; then
    git diff --cached --color=always -- "$file"
  else
    git diff --color=always -- "$file"
  fi
else
  ccat --color=always "$file"
fi
